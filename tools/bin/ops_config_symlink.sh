#!/usr/bin/env bash
#
# Copyright (C) 2015 Hewlett Packard Enterprise Development LP
# All Rights Reserved.
#
# The contents of this software are proprietary and confidential
# to the Hewlett Packard Enterprise Development LP. No part of
# this program  may be photocopied, reproduced, or translated
# into another programming language without prior written consent
# of the Hewlett Packard Enterprise Development LP.
# Code Coverage Generation Tool
#
# This script creates symbolik links to platform specific .ops-config files
# (generated by Kconfig frontend). Called from "menuconfig" make target.
#
# Parameters:
# $1 = $(DISTRO)
# $2 = $(BUILD_ROOT)
# $3 = $(CONFIGURED_PLATFORM)
# $4 = Name of the symlink

# Look for all available platforms and start creating symlinks to each of
# .ops-config files
for repo in yocto/*/meta-platform-$1-* ; do
  if [[ "$repo" =~ "yocto/poky" ]]; then
    continue
  fi
  ln -sf $2/$repo/.ops-config build/.ops-config-${repo##*platform-$1-}
done
ln -sf .ops-config-$3 $4
